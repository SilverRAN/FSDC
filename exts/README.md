These code are borrowed from https://github.com/kakaxi314/GuideNet